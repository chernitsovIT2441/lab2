Сегментация полей по спутниковым снимкам
Название и краткое описание задачи
Проект: Семантическая сегментация спутниковых снимков для выделения сельскохозяйственных полей и других типов земного покрова.

Задача: Разработать модель глубокого обучения, способную классифицировать каждый пиксель спутникового изображения на один из 10 классов: поля, дороги, леса, вода и другие типы территорий. Это задача семантической сегментации, где на выходе модели получается маска с метками классов для каждого пикселя входного изображения.

Цель и мотивация
Цель проекта: Создать автоматизированную систему для анализа спутниковых снимков и картографирования сельскохозяйственных угодий.

Мотивация:

Мониторинг сельского хозяйства: Автоматическое определение границ полей позволяет оценивать использование земель, прогнозировать урожайность и планировать сельскохозяйственные работы.

Экологический контроль: Отслеживание изменений лесных массивов, водных объектов и урбанизированных территорий.

Эффективность: Ручная разметка спутниковых снимков требует огромных временных затрат, автоматизация этой задачи ускоряет анализ больших территорий.

Использованные данные
Датасет: EuroSAT (Land Use and Land Cover Classification with Sentinel-2)

Источник: EuroSAT Dataset

Характеристики датасета:

27,000 размеченных спутниковых снимков

10 классов земного покрова:

AnnualCrop (сельскохозяйственные поля)
Forest (лес)
HerbaceousVegetation (травянистая растительность)
Highway (дороги/магистрали)
Industrial (промышленные зоны)
Pasture (пастбища)
PermanentCrop (многолетние культуры)
Residential (жилые зоны)
River (реки/вода)
SeaLake (моря/озера)
Модификация: Для задачи сегментации в демонстрационных целях созданы синтетические маски на основе классов изображений. В production-версии рекомендуется использовать датасеты с настоящими масками сегментации, например SpaceNet.

Архитектура модели и обоснование выбора
Базовая архитектура: U-Net
Была выбрана архитектура U-Net по следующим причинам:

Критерий	Обоснование
Эффективность при малых данных	U-Net отлично работает даже с ограниченным количеством размеченных данных благодаря архитектуре с пропускными соединениями
Точность границ	Сохранение высокоуровневых признаков из энкодера помогает восстанавливать четкие границы объектов
Популярность в спутниковой сегментации	Архитектура зарекомендовала себя как стандарт для задач дистанционного зондирования
Простота реализации	Относительно простая архитектура, легко обучается на стандартном оборудовании
Альтернативные архитектуры (для расширения)
DeepLabV3+: Использует atrous convolution для захвата контекста разных масштабов

SegFormer: Трансформерная архитектура, эффективная для глобального контекста

Метрики качества
Для оценки производительности модели используются следующие метрики:

1. IoU (Intersection over Union)
I
o
U
=
∣
A
∩
B
∣
∣
A
∪
B
∣
IoU= 
∣A∪B∣
∣A∩B∣
​
 
Где A - предсказанная маска, B - истинная маска. Измеряется для каждого класса и усредняется.

2. Dice Coefficient (F1-score)
D
i
c
e
=
2
∣
A
∩
B
∣
∣
A
∣
+
∣
B
∣
Dice= 
∣A∣+∣B∣
2∣A∩B∣
​
 
Более устойчив к дисбалансу классов, чем IoU.

Интерпретация метрик:
0.9-1.0: Отличное качество сегментации

0.7-0.9: Хорошее качество

0.5-0.7: Среднее качество

<0.5: Плохое качество (модель требует доработки)

Результаты
График обучения
text
Epoch 1: Loss=2.1845, IoU=0.2134
Epoch 2: Loss=1.8956, IoU=0.3128
Epoch 3: Loss=1.6543, IoU=0.3892
Epoch 4: Loss=1.4872, IoU=0.4215
Epoch 5: Loss=1.3568, IoU=0.4523
Итоговые метрики
Метрика	Значение
Средний IoU	0.4523
Dice Coefficient	0.5876
Визуализация результатов
https://segmentation_results.png

На визуализации представлены: оригинальные спутниковые снимки (слева), истинные маски (в центре) и предсказания модели (справа). Цвета соответствуют различным классам земного покрова.

Анализ результатов
Сильные стороны: Модель хорошо выделяет крупные однородные области (леса, вода)

Слабые стороны: Трудности с сегментацией мелких объектов и границ полей

Рекомендации: Для улучшения качества требуется больше эпох обучения и настоящие маски сегментации

Инструкция по запуску кода
Установка зависимостей
pip install torch torchvision matplotlib numpy Pillow tqdm requests
